import{r as v,R as u,j as e,c as Q}from"./client-B9F7oGqJ.js";const Y=[{urls:"stun:10.100.0.35:3478"}],$=n=>{const{signalingUrl:a,answerPeerId:i,useIceServers:h,mediaStream:p,onSignalingState:s,onIceState:c,onDataChannel:l}=n,t=v.useRef(null),o=v.useRef(null),S=v.useRef(null),I=v.useRef([]),d=v.useRef(null),g=v.useRef([]),[C,R]=v.useState(null),[j,x]=v.useState("idle"),m=v.useRef(s),T=v.useRef(c),E=v.useRef(l);v.useEffect(()=>{m.current=s,T.current=c,E.current=l},[s,c,l]);const A=v.useCallback(()=>{var f,k;try{(f=o.current)==null||f.close()}catch{}o.current=null;try{(k=t.current)==null||k.close()}catch{}t.current=null,x("idle")},[]),W=v.useCallback(async f=>{const k=o.current;if(k)if(f.kind==="offer"&&f.sdp)for(await k.setRemoteDescription(new RTCSessionDescription({type:"offer",sdp:f.sdp}));g.current.length>0;){const y=g.current.shift();y&&await k.addIceCandidate(new RTCIceCandidate(y))}else f.kind==="ice"&&f.candidate&&(k.remoteDescription?await k.addIceCandidate(new RTCIceCandidate(f.candidate)):g.current.push(f.candidate))},[]),U=v.useCallback(f=>{const k=S.current;if(!(!k||f.readyState!==WebSocket.OPEN))for(;I.current.length>0;){const y=I.current.shift();if(!y)continue;const b={type:"signal",from:{role:"answer",peerId:i},to:{role:"offer",peerId:k},data:{kind:"ice",candidate:y}};f.send(JSON.stringify(b))}},[i]),r=v.useCallback(async()=>{if(A(),!i)throw x("error"),new Error("answerPeerId is required");if(!p)throw x("error"),new Error("mediaStream is required (capture first)");const f=new WebSocket(a);t.current=f,f.onopen=()=>{var b;x("waiting_offer"),(b=m.current)==null||b.call(m,"Connected");const y={type:"register",payload:{role:"answer",peerId:i}};f.send(JSON.stringify(y))},f.onerror=()=>{var y;x("error"),(y=m.current)==null||y.call(m,"Error")},f.onclose=()=>{var y;(y=m.current)==null||y.call(m,"Disconnected")};const k=new RTCPeerConnection(h?{iceServers:Y}:{});o.current=k,p.getTracks().forEach(y=>k.addTrack(y,p)),k.onicecandidate=y=>{if(y.candidate&&f.readyState===WebSocket.OPEN){const b=S.current,L=typeof y.candidate.toJSON=="function"?y.candidate.toJSON():y.candidate;if(b){const P={type:"signal",from:{role:"answer",peerId:i},to:{role:"offer",peerId:b},data:{kind:"ice",candidate:L}};f.send(JSON.stringify(P))}else I.current.push(L)}},k.oniceconnectionstatechange=()=>{var y;(y=T.current)==null||y.call(T,k.iceConnectionState)},k.ondatachannel=y=>{const b=y.channel;d.current=b,R(b),E.current&&E.current(b),b.onclose=()=>R(null)},f.onmessage=async y=>{var L;const b=JSON.parse(y.data);if(b.type==="signal"&&b.data){if((L=b.from)!=null&&L.peerId&&(S.current=b.from.peerId,U(f)),await W(b.data),b.data.kind==="offer"&&b.data.sdp){const P=await k.createAnswer();await k.setLocalDescription(P);const J={type:"signal",from:{role:"answer",peerId:i},to:{role:"offer",peerId:b.from.peerId},data:{kind:"answer",sdp:P.sdp||""}};f.send(JSON.stringify(J)),x("connected"),U(f)}}else if(b.type==="offer"){await W({kind:"offer",sdp:b.payload.sdp});const P=await k.createAnswer();await k.setLocalDescription(P),f.send(JSON.stringify({type:"answer",payload:{sdp:P.sdp||""}})),x("connected")}else(b.type==="ice"||b.type==="ice-offer")&&await W({kind:"ice",candidate:b.payload.candidate})}},[i,a,h,p,A,W,U]),w=v.useCallback(f=>{const k=o.current;if(!k)return;const y=k.getSenders();f.getTracks().forEach(L=>{const P=y.find(J=>{var B;return((B=J.track)==null?void 0:B.kind)===L.kind});P?P.replaceTrack(L):k.addTrack(L,f)})},[]);v.useEffect(()=>()=>A(),[A]);const N=v.useMemo(()=>({start:r,close:A,replaceStream:w,dataChannel:C}),[r,A,w,C]);return{status:j,connection:N}};function X(n){const{apiKey:a,localPeerId:i,onOpen:h,onData:p}=n;if(typeof Peer>"u")throw new Error("SkyWay old SDK (Peer) is not loaded");if(!a)throw new Error("SkyWay API key is required");const s=new Peer(i||void 0,{key:a,debug:2});let c=null,l=null,t=null;const o={readyState:"connecting",onopen:null,onmessage:null,send:d=>{c&&c.open&&c.send(typeof d=="string"?d:JSON.stringify(d))},close:()=>{try{c&&c.close&&c.close(!0)}catch{}}};s.on("open",d=>{h&&h(d)}),s.on("connection",d=>{c=d,o.readyState=d.open?"open":"connecting",d.once("open",()=>{o.readyState="open",o.onopen&&o.onopen()}),d.on("data",g=>{o.onmessage&&o.onmessage({data:g}),p&&p(g)}),d.on("close",()=>{o.readyState="closed"})}),s.on("call",d=>{l=d;try{d.answer(t||null,{})}catch(g){console.error("OldSkyWay Answer: failed to answer media call",g)}});function S(d){t=d;try{if(l&&l.pc&&d){const g=l.pc,C=g!=null&&g.getSenders?g.getSenders():[];d.getTracks().forEach(R=>{const j=C==null?void 0:C.find(x=>{var m;return((m=x.track)==null?void 0:m.kind)===R.kind});j&&j.replaceTrack&&j.replaceTrack(R)})}}catch{}}function I(){try{l&&l.close&&l.close(!0)}catch{}try{c&&c.close&&c.close(!0)}catch{}try{s&&s.destroy&&s.destroy()}catch{}o.readyState="closed"}return{peerId:null,dataChannel:o,setLocalStream:S,close:I}}const D=n=>v.useSyncExternalStore(n.subscribe,n.get,n.get),Z="ws://localhost:8080",q="e316eaa7-4c1c-468c-b23a-9ce51b074ab7",ee="ws://127.0.0.1:8081",te={engine:"pure",answerPeerId:"tractor-01",signalingUrl:Z,useStunTurn:!0,skywayApiKey:q,skywayLocalId:"",skywayMyId:"(waiting)"},G={width:1920,height:1280,frameRate:30,bitrate:1e6,deviceId:"default"},ne={disableTcc:!0,disableTwccExtmap:!0,disableRemb:!0,disableNackPliFir:!1,disableRtcpRsize:!1},re={signaling:"Disconnected",stun:"Waiting...",turn:"Waiting...",control:"closed",autorun:"Disconnected"},ae={},se={channel:null,state:"closed"},z={lat:0,lon:0,gnssQuality:0,gnssSpeed:0,heading:0,headingError:0,lateralError:0,steerAngle:0,realSteerAngle:0,stopStatus:0},ie=({topics:n,url:a})=>{const i=u.useRef(null),h=u.useCallback(()=>{const s=i.current;if(s&&(s.readyState===WebSocket.OPEN||s.readyState===WebSocket.CONNECTING))return s;try{const c=new WebSocket(a);return i.current=c,c.onopen=()=>{n.statuses.update(l=>({...l,autorun:"Connected"}));try{c.send(JSON.stringify({type:"remote-control"}))}catch{}},c.onerror=()=>n.statuses.update(l=>({...l,autorun:"Error"})),c.onclose=()=>n.statuses.update(l=>({...l,autorun:"Disconnected"})),c.onmessage=l=>{var t;try{const o=JSON.parse(l.data);if((o==null?void 0:o.type)==="autorun-output-data"){const S=((t=o.payload)==null?void 0:t.outputAutorunInfo)||o.payload||o,I={...z,...S};n.autorunTelemetry.set(I)}}catch(o){console.warn("Autorun message parse failed",o)}},c}catch(c){return n.statuses.update(l=>({...l,autorun:"Error"})),console.error("Failed to open autorun socket",c),null}},[n.autorunTelemetry,n.statuses,a]);return u.useEffect(()=>{const s=h();return()=>{try{s==null||s.close()}catch{}i.current=null}},[h]),{forwardControl:u.useCallback(s=>{const c=h();if(c&&c.readyState===WebSocket.OPEN)try{c.send(JSON.stringify({type:"inputAutorunInfo",payload:{inputInfo:s}}))}catch(l){console.warn("Send to autorun failed",l)}},[h])}},ce=({topics:n})=>{const a=u.useCallback(()=>{const s=n.stream.get();try{s==null||s.getTracks().forEach(c=>c.stop())}catch{}n.stream.set(null)},[n.stream]),i=u.useCallback(async()=>{var o,S,I;const s=n.videoProfile.get(),c={video:{width:V(s.width),height:V(s.height),frameRate:V(s.frameRate),deviceId:s.deviceId&&s.deviceId!=="default"?{exact:s.deviceId}:void 0},audio:!1},l=await navigator.mediaDevices.getUserMedia(c);a(),n.stream.set(l);const t=l.getVideoTracks()[0];if(t&&typeof t.getCapabilities=="function"){const d=t.getCapabilities();n.capabilities.set({widthMax:(o=d.width)==null?void 0:o.max,heightMax:(S=d.height)==null?void 0:S.max,frameRateMax:(I=d.frameRate)==null?void 0:I.max})}else n.capabilities.set({});return l},[a,n.stream,n.videoProfile,n.capabilities]),h=u.useCallback(async s=>{var t;const c=(t=n.stream.get())==null?void 0:t.getVideoTracks()[0];if(!c)return;const l={};Number.isFinite(s.width)&&(l.width={ideal:Number(s.width)}),Number.isFinite(s.height)&&(l.height={ideal:Number(s.height)}),Number.isFinite(s.frameRate)&&(l.frameRate={ideal:Number(s.frameRate)});try{await c.applyConstraints(l);try{c.contentHint="motion"}catch{}}catch(o){console.warn("applyConstraints failed",o)}},[n.stream]),p=u.useCallback(async()=>{try{const c=(await navigator.mediaDevices.enumerateDevices()).filter(l=>l.kind==="videoinput");n.devices.set(c)}catch(s){console.warn("enumerateDevices failed",s)}},[n.devices]);return u.useEffect(()=>{p();const s=()=>p();return navigator.mediaDevices.addEventListener("devicechange",s),()=>{navigator.mediaDevices.removeEventListener("devicechange",s)}},[p]),{capture:i,stop:a,applyOutboundConstraints:h,refreshDevices:p}},V=n=>typeof n=="number"&&Number.isFinite(n)?n:void 0,oe=({topics:n,forwardControl:a,applyVideoQuality:i})=>{const h=u.useRef(z),p=u.useRef(null);u.useEffect(()=>n.autorunTelemetry.subscribe(t=>{h.current=t}),[n.autorunTelemetry]);const s=u.useCallback(t=>{n.statuses.update(o=>({...o,control:t})),n.controlChannel.update(o=>({...o,state:t}))},[n.controlChannel,n.statuses]),c=u.useCallback(async t=>{if((t==null?void 0:t.type)==="inputAutorunInfo"){a(t);return}if((t==null?void 0:t.type)==="videoQualityChange"){const o={width:M(t.width),height:M(t.height),frameRate:M(t.framerate),bitrate:M(t.bitrate)};n.videoProfile.update(S=>({...S,...o})),await i(o);return}(t==null?void 0:t.type)==="offerInferenceResults"&&console.log("Received inference results from monitor:",t.payload)},[i,a,n.videoProfile]),l=u.useCallback(t=>{var j;if((j=p.current)==null||j.call(p),!t){n.controlChannel.set({channel:null,state:"closed"}),s("closed");return}n.controlChannel.set({channel:t,state:t.readyState||"connecting"}),s(t.readyState??"connecting");const o=()=>s("open"),S=()=>{s("closed"),n.controlChannel.get().channel===t&&n.controlChannel.set({channel:null,state:"closed"})},I=x=>{const m=x==null?void 0:x.data;let T=m;try{T=typeof m=="string"?JSON.parse(m):m}catch{}c(T)};let d=null;if(d=window.setInterval(()=>{if(t.readyState!=="open")return;const x={...z,...h.current};try{t.send(JSON.stringify({type:"outputAutorunInfo",payload:x}))}catch(m){console.warn("Send telemetry failed",m)}},33),typeof t.addEventListener=="function"){t.addEventListener("open",o),t.addEventListener("close",S),t.addEventListener("message",I),p.current=()=>{d&&window.clearInterval(d),t.removeEventListener("open",o),t.removeEventListener("close",S),t.removeEventListener("message",I)};return}const g=t.onmessage,C=t.onopen,R=t.onclose;t.onmessage=x=>{I(x),typeof g=="function"&&g(x)},t.onopen=()=>{o(),typeof C=="function"&&C()},t.onclose=()=>{S(),typeof R=="function"&&R()},p.current=()=>{d&&window.clearInterval(d),t.onmessage=g,t.onopen=C,t.onclose=R}},[c,s,n.controlChannel]);return u.useEffect(()=>()=>{var t;return(t=p.current)==null?void 0:t.call(p)},[]),{attachControlChannel:l}},M=n=>typeof n=="number"&&Number.isFinite(n)?n:null,O=n=>{let a=n;const i=new Set,h=()=>{const t=a;i.forEach(o=>o(t))};return{get:()=>a,set:t=>{a=t,h()},update:t=>{a=t(a),h()},subscribe:t=>(i.add(t),()=>{i.delete(t)})}},le=()=>({config:O(te),videoProfile:O(G),feedback:O(ne),statuses:O(re),capabilities:O(ae),devices:O([]),stream:O(null),autorunTelemetry:O(z),controlChannel:O(se)}),F=({title:n,children:a})=>e.jsxs("fieldset",{style:{marginTop:8,padding:8,width:"max-content"},children:[e.jsx("legend",{children:n}),a]}),de=()=>{const n=u.useRef();n.current||(n.current=le());const a=n.current,i=D(a.config),h=D(a.videoProfile),p=D(a.feedback),s=D(a.statuses),c=D(a.devices),l=D(a.capabilities),t=D(a.stream),o=D(a.autorunTelemetry),S=D(a.controlChannel),I=u.useRef(null),d=u.useRef(null),g=u.useCallback((r,w)=>{a.config.update(N=>({...N,[r]:w}))},[a.config]),C=u.useCallback(r=>{a.videoProfile.update(w=>({...w,...r}))},[a.videoProfile]),R=u.useCallback((r,w)=>{a.feedback.update(N=>({...N,[r]:w}))},[a.feedback]),j=ce({topics:a}),{forwardControl:x}=ie({topics:a,url:ee}),{attachControlChannel:m}=oe({topics:a,forwardControl:x,applyVideoQuality:async r=>{const w=ue(r);a.videoProfile.update(N=>({...N,...w})),await j.applyOutboundConstraints(w)}}),T=u.useRef(m);u.useEffect(()=>{T.current=m},[m]);const{connection:E}=$({signalingUrl:i.signalingUrl,answerPeerId:i.answerPeerId||"tractor-1",useIceServers:i.useStunTurn,mediaStream:t,onSignalingState:r=>a.statuses.update(w=>({...w,signaling:r})),onIceState:r=>a.statuses.update(w=>({...w,stun:r})),onDataChannel:m}),A=u.useCallback(async()=>{i.engine==="pure"&&(a.stream.get()||await j.capture().catch(r=>console.warn("Capture before connect failed",r)),E.start().catch(r=>{console.error(r),a.statuses.update(w=>({...w,signaling:"Error"}))}))},[j,i.engine,E,a.statuses,a.stream]);u.useEffect(()=>{i.engine!=="pure"&&E.close()},[i.engine,E]),u.useEffect(()=>{t&&i.engine==="pure"&&E.replaceStream(t)},[i.engine,E,t]),u.useEffect(()=>{I.current&&t&&(I.current.srcObject=t)},[t]);const W=u.useRef(null);u.useEffect(()=>{const r=h.deviceId;W.current!==null&&W.current!==r&&a.stream.get()&&j.capture(),W.current=r},[h.deviceId]),u.useEffect(()=>{c.length>0&&(!h.deviceId||h.deviceId==="default")&&C({deviceId:c[0].deviceId})},[c,C,h.deviceId]),u.useEffect(()=>{var r;if(i.engine!=="oldskyway"){(r=d.current)==null||r.close(),d.current=null;return}if(typeof window.Peer>"u"){console.error("SkyWay old SDK (Peer) is not loaded on this page");return}try{const w=X({apiKey:i.skywayApiKey,localPeerId:i.skywayLocalId||void 0,onOpen:f=>g("skywayMyId",f)});d.current=w,T.current(w.dataChannel);const N=a.stream.get();N&&w.setLocalStream(N)}catch(w){console.error("OldSkyWay answer init failed",w);return}return()=>{var w;(w=d.current)==null||w.close(),d.current=null}},[i.engine,i.skywayApiKey,i.skywayLocalId,g,a.stream]),u.useEffect(()=>{if(i.engine!=="oldskyway")return;const r=d.current;r&&t&&r.setLocalStream(t)},[i.engine,t]),u.useEffect(()=>{i.engine==="newskyway"&&m(null)},[m,i.engine]);const U=i.engine;return e.jsxs("div",{style:{padding:16,fontFamily:"sans-serif"},children:[e.jsx("h1",{children:"Vehicle (Answer) UI"}),e.jsx("p",{children:"Choose engine, capture camera, then connect. Signaling defaults to ws://localhost:8080."}),e.jsxs(F,{title:"WebRTC Engine",children:[e.jsxs("label",{children:[e.jsx("input",{type:"radio",name:"engine",value:"pure",checked:i.engine==="pure",onChange:()=>g("engine","pure")}),"Pure WebRTC"]}),e.jsxs("label",{style:{marginLeft:12},children:[e.jsx("input",{type:"radio",name:"engine",value:"oldskyway",checked:i.engine==="oldskyway",onChange:()=>g("engine","oldskyway")}),"Old SkyWay"]}),e.jsxs("label",{style:{marginLeft:12},children:[e.jsx("input",{type:"radio",name:"engine",value:"newskyway",checked:i.engine==="newskyway",onChange:()=>g("engine","newskyway")}),"New SkyWay (stub)"]})]}),e.jsxs(F,{title:"Camera",children:[e.jsxs("div",{style:{marginTop:4},children:["Select Device:",e.jsxs("select",{value:h.deviceId,onChange:r=>C({deviceId:r.target.value}),style:{marginLeft:8},children:[e.jsx("option",{value:"default",children:"Default Camera"}),c.map(r=>e.jsx("option",{value:r.deviceId,children:r.label||r.deviceId},r.deviceId))]}),e.jsx("button",{style:{marginLeft:8},onClick:()=>void j.capture(),children:"Get Capture"})]}),e.jsx("div",{style:{marginTop:8},children:e.jsx("video",{ref:I,autoPlay:!0,playsInline:!0,muted:!0,style:{width:220,height:140,background:"#000",borderRadius:6}})}),e.jsxs("div",{style:{marginTop:6,fontSize:12,color:"#333"},children:["Max Resolution / FPS:Â ",l.widthMax&&l.heightMax?`${l.widthMax}x${l.heightMax}`:"N/A"," | ",l.frameRateMax??"N/A"," fps"]})]}),i.engine==="pure"&&e.jsxs(e.Fragment,{children:[e.jsxs(F,{title:"Pure WebRTC Connection",children:[e.jsxs("div",{style:{marginTop:6},children:["Vehicle Peer ID:",e.jsx("input",{type:"text",value:i.answerPeerId,onChange:r=>g("answerPeerId",r.target.value),style:{width:180,marginLeft:6},placeholder:"tractor-01"})]}),e.jsxs("div",{style:{marginTop:6},children:["Signaling WS URL:",e.jsx("input",{type:"text",value:i.signalingUrl,onChange:r=>g("signalingUrl",r.target.value),style:{width:220,marginLeft:6}}),e.jsx("button",{style:{marginLeft:6},onClick:()=>void A(),children:"Connect"}),e.jsx("button",{style:{marginLeft:6},onClick:()=>void j.capture(),children:"Get Capture"})]})]}),e.jsx("h3",{children:"Network Status"}),e.jsx("table",{children:e.jsxs("tbody",{children:[e.jsx("tr",{children:e.jsxs("th",{children:["Signaling: ",e.jsx("span",{children:s.signaling})]})}),e.jsx("tr",{children:e.jsxs("th",{children:["STUN: ",e.jsx("span",{children:s.stun})]})}),e.jsx("tr",{children:e.jsxs("th",{children:["TURN: ",e.jsx("span",{children:s.turn})]})})]})}),e.jsxs("div",{style:{marginTop:4,fontSize:12,color:"#333"},children:["DataChannel: ",S.state," / Autorun WS: ",s.autorun]}),e.jsxs("div",{style:{marginTop:2,fontSize:12,color:"#333"},children:["Telemetry: ",o.gnssSpeed??0," km/h / HeadingErr"," ",o.headingError??0]}),e.jsxs("div",{style:{margin:"4px 0 10px 0"},children:[e.jsx("input",{type:"checkbox",id:"use-stun-turn",checked:i.useStunTurn,onChange:r=>g("useStunTurn",r.target.checked)}),e.jsx("label",{htmlFor:"use-stun-turn",children:"Use STUN/TURN (unchecked = host only)"})]}),e.jsxs(F,{title:"Feedback Options",children:[e.jsxs("div",{children:[e.jsx("input",{type:"checkbox",id:"disable-tcc",checked:p.disableTcc,onChange:r=>R("disableTcc",r.target.checked)}),e.jsx("label",{htmlFor:"disable-tcc",children:"Disable transport-cc feedback"})]}),e.jsxs("div",{children:[e.jsx("input",{type:"checkbox",id:"disable-twcc-extmap",checked:p.disableTwccExtmap,onChange:r=>R("disableTwccExtmap",r.target.checked)}),e.jsx("label",{htmlFor:"disable-twcc-extmap",children:"Disable TWCC extmap"})]}),e.jsxs("div",{children:[e.jsx("input",{type:"checkbox",id:"disable-remb",checked:p.disableRemb,onChange:r=>R("disableRemb",r.target.checked)}),e.jsx("label",{htmlFor:"disable-remb",children:"Disable REMB feedback"})]}),e.jsxs("div",{children:[e.jsx("input",{type:"checkbox",id:"disable-nack-pli-fir",checked:p.disableNackPliFir,onChange:r=>R("disableNackPliFir",r.target.checked)}),e.jsx("label",{htmlFor:"disable-nack-pli-fir",children:"Disable NACK / PLI / FIR"})]}),e.jsxs("div",{children:[e.jsx("input",{type:"checkbox",id:"disable-rtcp-rsize",checked:p.disableRtcpRsize,onChange:r=>R("disableRtcpRsize",r.target.checked)}),e.jsx("label",{htmlFor:"disable-rtcp-rsize",children:"Disable reduced-size RTCP"})]})]}),e.jsxs(F,{title:"Video Quality",children:[e.jsxs("div",{style:{marginTop:4},children:["Height:",e.jsx("input",{type:"number",value:h.height??"",onChange:r=>C({height:K(r.target.value)}),style:{width:100,marginLeft:6}})]}),e.jsxs("div",{style:{marginTop:4},children:["Width:",e.jsx("input",{type:"number",value:h.width??"",onChange:r=>C({width:K(r.target.value)}),style:{width:100,marginLeft:6}})]}),e.jsxs("div",{style:{marginTop:4},children:["FrameRate:",e.jsx("input",{type:"number",value:h.frameRate??"",onChange:r=>C({frameRate:K(r.target.value)}),style:{width:100,marginLeft:6}})," ","Hz"]}),e.jsxs("div",{style:{marginTop:4},children:["Bitrate:",e.jsx("input",{type:"number",value:h.bitrate??"",onChange:r=>C({bitrate:K(r.target.value)}),style:{width:140,marginLeft:6}})," ","bps"]}),e.jsx("button",{style:{marginTop:6},onClick:()=>void j.applyOutboundConstraints(h),children:"Set Video Quality"}),e.jsx("button",{style:{marginTop:6,marginLeft:8},onClick:()=>C(G),children:"Reset"})]})]}),i.engine==="oldskyway"&&e.jsxs(F,{title:"Old SkyWay",children:[e.jsxs("div",{style:{marginTop:6},children:["SkyWay API Key:",e.jsx("input",{type:"text",value:i.skywayApiKey,onChange:r=>g("skywayApiKey",r.target.value),style:{width:280,marginLeft:6},placeholder:"Enter SkyWay API Key"})]}),e.jsxs("div",{style:{marginTop:6},children:["Local Peer ID (optional):",e.jsx("input",{type:"text",value:i.skywayLocalId,onChange:r=>g("skywayLocalId",r.target.value),style:{width:220,marginLeft:6},placeholder:"auto or specify fixed id"}),e.jsxs("span",{style:{marginLeft:8},children:["My ID: ",e.jsx("span",{children:i.skywayMyId})]})]}),e.jsx("small",{children:"SkyWay old SDK must be loaded separately in the page."})]}),i.engine==="newskyway"&&e.jsx(F,{title:"New SkyWay",children:e.jsx("p",{children:"Stub. Wire a driver that matches the createX + deps pattern."})}),e.jsxs("div",{style:{marginTop:12,color:"#444"},children:[e.jsx("strong",{children:"Current engine"})," ",U]})]})},K=n=>{const a=Number(n);return Number.isFinite(a)?a:null},ue=n=>{const a={width:_(n.width),height:_(n.height),frameRate:_(n.frameRate),bitrate:_(n.bitrate)};return typeof n.deviceId=="string"&&(a.deviceId=n.deviceId),a},_=n=>typeof n=="number"&&Number.isFinite(n)?n:null,H=document.getElementById("root");if(!H)throw new Error("Root element #root not found");Q(H).render(e.jsx(u.StrictMode,{children:e.jsx(de,{})}));
